<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="/stylesheets/index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito&family=Quicksand:wght@700&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <title>404:formula tu pregunta</title>
    <link rel="icon" type="image/svg+xml" href="/images/favicon.svg">

</head>

<body>
    <%- include ("fragments/navbar")%>
        <main>
            <form class="login-form" method="POST" action="/preguntas/formular">
                <h3>Formula tu pregunta</h3>
                <h5>Titulo</h5>
                <h7>Se claro, imagina que le est√°s preguntando a cualquier persona.</h7>
                <div class="form-element">
                    <input name="title" class="form-control" type="text" placeholder="T√≠tulo de la pregunta" required maxlength="100">
                </div>
                <h5>Cuerpo</h5>
                <h7>Incluye toda la informaci√≥n necesaria para poder responder tu pregunta</h7>
                <div class="form-element">
                    <textarea name="body" class="form-control" id="exampleFormControlTextarea1" rows="15" required maxlength="1000"></textarea>
                </div>
                <h5>Etiquetas</h5>
                <h7>A√±ade hasta 5 etiquetas, en min√∫sculas y seguidas por un <b>espacio</b>, para describir sobre qu√© trata tu pregunta.</h7>
                <div class="form-element">
                    <div id="tags_rendered">

                    </div>
                </div>
                <div class="form-element">
                    <input autocomplete="off" id="tagInput" class="form-control" type="text" placeholder="Por ejemplo: node sql linux" value='' maxlength="20">
                    <input autocomplete="off" type="hidden" id="hiddenTagInput" name="tags">
                </div>

                <input type="submit" class="btn form-element" value="Manda tu pregunta">
            </form>
            <% if (locals.errors) { %>
                <div class="alert alert-dismissible error-information fade show" role="alert">
                    <h3>Cuidado, chimp </h3>
                    <h3> *sonidos de angry monkyü¶ß*</h3>
                    <ul>
                        <% errors.forEach(err => { %>
                            <li>
                                <%= err.msg %>
                            </li>
                            <% }) %>
                    </ul>
                    <button type="button" id="close-alert" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </button>
                </div>
                <% } %>
        </main>

        <script>
            $(function() {
                let tagsArray = [];
                $('#tagInput').keyup(function(event) {
                    const hiddenTags = $('#hiddenTagInput');
                    if (event.which === 32) { //spacebar
                        const userText = $(this).val().trim().toLowerCase();
                        if (userText !== '' && !tagsArray.includes(userText) && tagsArray.length < 5) {
                            const tag = $("<span></span>").text($(this).val()).addClass("tag-element");
                            tag.append($('<a></a>').addClass("deleteTagInput").text('üóëÔ∏è').click(function() {
                                const index = tagsArray.indexOf(userText);
                                if (index > -1) {
                                    tagsArray.splice(index, 1);
                                }
                                $(this).parent().remove();
                                hiddenTags.val(tagsArray.join());
                            }))
                            tagsArray.push(userText);
                            $('#tags_rendered').append(tag);
                            hiddenTags.val(tagsArray.join());
                        }
                        console.log(tagsArray);
                        console.log(hiddenTags.val());
                        $(this).val('');
                    }
                });

            });
        </script>
</body>

</html>